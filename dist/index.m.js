import t from"isomorphic-unfetch";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n(t,e)}function n(t,e){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},n(t,e)}var r=/*#__PURE__*/function(){function e(){this.baseUrl="https://search.imdbot.workers.dev/"}return e.prototype.request=function(e,n){try{var r=""+this.baseUrl+e,o=Object.assign({},n,{"Content-Type":"application/json"});return Promise.resolve(t(r,o)).then(function(t){var e;function n(n){if(e)return n;throw new Error(t.statusText)}var r=function(){if(t.ok)return Promise.resolve(t.json()).then(function(t){return e=1,t})}();return r&&r.then?r.then(n):n(r)})}catch(t){return Promise.reject(t)}},e}();function o(t,e,n){if(!t.s){if(n instanceof i){if(!n.s)return void(n.o=o.bind(null,t,e));1&e&&(e=n.s),n=n.v}if(n&&n.then)return void n.then(o.bind(null,t,e),o.bind(null,t,2));t.s=e,t.v=n;const r=t.o;r&&r(t)}}var i=/*#__PURE__*/function(){function t(){}return t.prototype.then=function(e,n){var r=new t,i=this.s;if(i){var u=1&i?e:n;if(u){try{o(r,1,u(this.v))}catch(t){o(r,2,t)}return r}return this}return this.o=function(t){try{var i=t.v;1&t.s?o(r,1,e?e(i):i):n?o(r,1,n(i)):o(r,2,i)}catch(t){o(r,2,t)}},r},t}();function u(t){return t instanceof i&&1&t.s}var c,s=/*#__PURE__*/function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.getRandomMovies=function(){try{var t,e=function(){return Array.from(r.values()).slice(0,10)},n=this,r=new Map,c=function(t,e,n){for(var r;;){var c=t();if(u(c)&&(c=c.v),!c)return s;if(c.then){r=0;break}var s=n();if(s&&s.then){if(!u(s)){r=1;break}s=s.s}if(e){var f=e();if(f&&f.then&&!u(f)){r=2;break}}}var h=new i,a=o.bind(null,h,2);return(0===r?c.then(p):1===r?s.then(v):f.then(d)).then(void 0,a),h;function v(r){s=r;do{if(e&&(f=e())&&f.then&&!u(f))return void f.then(d).then(void 0,a);if(!(c=t())||u(c)&&!c.v)return void o(h,1,s);if(c.then)return void c.then(p).then(void 0,a);u(s=n())&&(s=s.v)}while(!s||!s.then);s.then(v).then(void 0,a)}function p(t){t?(s=n())&&s.then?s.then(v).then(void 0,a):v(s):o(h,1,s)}function d(){(c=t())?c.then?c.then(p).then(void 0,a):p(c):o(h,1,s)}}(function(){return!t&&r.size<10},void 0,function(){return Promise.resolve(n.request()).then(function(e){var n=e.description;n.forEach(function(t){r.has(t["#IMDB_ID"])||r.set(t["#IMDB_ID"],t)}),n.length<10&&(t=1)})});return Promise.resolve(c&&c.then?c.then(e):e())}catch(t){return Promise.reject(t)}},r.getMovieById=function(t){try{return Promise.resolve(this.request("?tt="+t))}catch(t){return Promise.reject(t)}},r.searchMovies=function(t){try{return Promise.resolve(this.request("q="+encodeURIComponent(t))).then(function(t){return t.description})}catch(t){return Promise.reject(t)}},n}(r),f=/*#__PURE__*/function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n}(r);c=f,[s].forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(e){Object.defineProperty(c.prototype,e,Object.getOwnPropertyDescriptor(t.prototype,e))})});export{f as default};
